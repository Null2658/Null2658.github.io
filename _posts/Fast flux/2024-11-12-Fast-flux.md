---
title: Fast Flux
date: 2024-11-14 
tags: [DNS, Network security]
---
<div dir="rtl" markdown="1">

لماذا يصعب على محلل الأمن السيبراني تعقب الأنشطة الضارة والمشبوهة، مثل التصيد الاحتيالي **(Phishing)**، ونشر البرمجيات الخبيثة **(Malware)** وغيرها . يعود ذلك إلى استخدام المهاجمين تقنيات مثل ***Fast Flux**، التي تُستخدم لإخفاء هويتها وتسهيل تغيير مواقع الخوادم بسرعة، مما يجعل عملية التتبع أكثر تعقيدًا.

## ما هي تقنية Fast Flux:
كما يوضح نموذج [The Pyramid of Pain](https://www.sans.org/tools/the-pyramid-of-pain/)، تعتبر عناوين IP وأسماء النطاقات (Domain) من أسهل الأمور التي يمكن للمهاجمين تغييرها والتلاعب بها. تقنية Fast Flux هي تقنية تجمع بين هذين العنصرين، حيث يقوم المهاجم بربط نطاق ضار بعدد من عناوين IP، والتي تنتمي إلى شبكة كبيرة من البوتات. ثم يتم توجيه حركة المرور إلى النطاق الضار من خلال هذه العناوين المتغيرة بشكل مستمر.

<figure>
<img src="/assets/img/The_Pyramid_of_Pain.png" alt="The_Pyramid_of_Pain">
</figure>
## كيفية عمل Fast Flux:
### 1. Single Fast Flux:

في هذا النوع، يتم تغيير عناوين IP المرتبطة بنطاق معين بسرعة باستخدام إعدادات DNS تعتمد على قيمة تغير Time to Live (TTL) منخفضة.
### آلية العمل:
• الضحية:عامر، موظف في قسم الموارد البشرية.
• شبكة البوتات: مجموعة من الأجهزة المخترقة تعمل كوسيط بين الضحية والنطاق الخبيث.
• إعدادات DNS: يتم استخدام إعدادات لتغيير عناوين IP بسرعة، مما يصعب التتبع.

### لنأخذ سيناريو بسيط:
• وصل عامر من قسم الموارد البشرية بريدًا إلكترونيًا احتياليًا يحتوي على عرض مغرٍ لأجهزة إلكترونية عبر الموقع **freeiphone.com**.
• عند دخوله الموقع، تم إرسال طلب إلى خادم DNS لاسترجاع عنوان IP الخاص بالموقع.
• العنوان الذي تم إرجاعه ينتمي إلى شبكة كبيرة من الأجهزة المصابة (البوتات)، التي تعمل كوسيط بين عامر والموقع الاحتيالي.
• العنوان الذي تم إرجاعه ينتمي إلى شبكة كبيرة من الأجهزة المصابة (البوتات)، التي تعمل كوسيط بين عامر والموقع الاحتيالي.
• التغيير السريع للعناوين يتم عبر Time to Live (TTL) منخفض، مما يصعب تعقب الموقع والأنشطة الضارة.

<figure>
<img src="/assets/img/Amer_case.png" alt="Amer_case">
</figure>

### 2.Double Fast Flux:
يعتمد على نفس الأسلوب Single  ولكن لزيادة التعقيد يتم  اضافة طبقة اخرى حيث يتم تغير nameservers بشكل مستمر.
في هذه الحالة ، تكون nameservers (مثل ns1.freeiphone.com وns2.freeiphone.com) جزءًا من شبكة البوتات وتعمل خوادم DNS مسؤولة. يتم تغيير هذه الخوادم بشكل دوري لجعل التتبع والحظر أكثر صعوبة.

## طريقة كشف الهجوم:
• اذا تم ملاحظة تغيير السريعة وغير طبيعي  في عناوين IP و خوادم الأسماء.
• تحليل قيم TTL ودورة حياة عناوين IP.

## طريقة منع الهجوم :
• ركز على مراقبة وتحليل حركة DNS.
•  الاعتماد على Threat intelligence.
•  اعتمد أنظمة حماية متقدمة مثل DNSSEC وجدران الحماية.
•  تعاون مع مزودي الخدمة لتعطيل لنطاق و البنية التحتية للمهاجمين.









 </div>
 
